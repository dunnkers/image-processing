\documentclass{article}
\usepackage{styles}

\title{Image Processing\\
    Lab 4}
\author{Kevin Gevers (s25595987) \\ Jeroen Overschie (s2995697)\\Group 01}
\date{\today}

\begin{document}

\maketitle

Note, that all used source code can be found attached next to this report's pdf file. Its structure should be self-explanatory; all requested functions are named accordingly and any extra functions are explained in the report. Note that (almost) every function has a corresponding test script, which is named just like its function, but with a suffix '\texttt{\_test}'. Where possible, we followed the terminology from the book \citep{gonzalez2008digital} for variable naming.

\section*{Exercise 1}
In this first exercise, we are asked to solve Problem 9.9 from the book, from the Morphological Image Processing chapter. The exercise entails sketching dilations and erosions from some (binary) set using various Structuring Elements (SE's). Let us first illustrate the set $A$ on which the morphological operations will be applied on, and the respective Structuring Elements, $B^1$, $B^2$, $B^3$ and $B^4$.

\begin{figure}[H]
     \centering
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/pen&paper/A.svg}
         \caption{The input set $A$.}
         \label{fig:set_A}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.08\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/pen&paper/B1.svg}
         \caption{$B^1$}
         \label{fig:SE_B1}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.15\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/pen&paper/B2.svg}
         \caption{$B^2$}
         \label{fig:SE_B2}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.11\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/pen&paper/B3.svg}
         \caption{$B^3$}
         \label{fig:SE_B3}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.18\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/pen&paper/B4.svg}
         \caption{$B^4$}
         \label{fig:SE_B4}
     \end{subfigure}
     
    \caption{An overview of the Structuring Elements $B^1 ... B^4$ to be used in Exercise 1, along with its input set, $A$.}
    \label{fig:ex1_overview}
\end{figure}

A notable observation is that, for the Structuring Elements, it is not always the case that the origin lies in the middle of the shape. For most, the origin is indeed in the shape center, but for $B^3$ (see Figure~\ref{fig:SE_B3}) the origin is at the bottom-right point of the shape. This is important to note since it has an effect on the dilation/erosion procedures. For the other shapes, the origin lies at the center point.

\subsection*{(a)} In the first assignment, we first erode A by $B^4$ and then dilate the result by $B^2$, i.e. $(A \ominus B^4) \oplus B^2$. The result of the operation can be seen in Figure~\ref{fig:ex1_a}.

\begin{figure}[H]
     \centering
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/pen&paper/A.svg}
         \caption{The input set $A$.}
         \label{fig:ex1_a-inputset}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/pen&paper/(a)-step1.svg}
         \caption{$(A \ominus B^4)$}
         \label{fig:ex1_a-step1}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/pen&paper/(a)-step2.svg}
         \caption{$(A \ominus B^4) \oplus B^2$}
         \label{fig:ex1_a-step2}
     \end{subfigure}
     
    \caption{Overview of the erosion and dilation of assignment (a), using the SE's $B^4$ (Figure~\ref{fig:SE_B4}) and $B^2$ (Figure~\ref{fig:SE_B2}).}
    \label{fig:ex1_a}
\end{figure}

It can be observed that the first erosion strips off almost all foreground pixels. The circle shape only fits a very select amount of pixels, leaving out only what looks like the 'skeleton' of the original cross shape. In fact, since the circle is of diameter $L$, meaning it can 'perfectly' fit the sections of the cross, it can be seen as a \textit{maximum disk} for $A$. In the following dilation operation, many foreground pixels are added around the cross shape, and including some interesting looking 'tips' at the end of the cross points.

\subsection*{(b)} Next, we erode by $B^1$ and then dilate by $B^3$, i.e. $(A \ominus B^1) \oplus B^3$. The result of this operation can be seen in Figure~\ref{fig:ex1_b}.

\begin{figure}[H]
     \centering
     \begin{subfigure}[b]{0.28\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/pen&paper/A.svg}
         \caption{The input set $A$.}
         \label{fig:ex1_b-inputset}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.29\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/pen&paper/(b)-step1.svg}
         \caption{$(A \ominus B^1)$}
         \label{fig:ex1_b-step1}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.37\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/pen&paper/(b)-step2.svg}
         \caption{$(A \ominus B^1) \oplus B^3$}
         \label{fig:ex1_b-step2}
     \end{subfigure}
     
    \caption{Overview of the erosion and dilation of assignment (b), using the SE's $B^1$ (Figure~\ref{fig:SE_B1}) and $B^3$ (Figure~\ref{fig:SE_B3}).}
    \label{fig:ex1_b}
\end{figure}

It can be seen that the erosion of the shape by the rectangular SE makes that much of the vertical foreground pixels remain, but where the rectangular shape does fit is mainly in the horizontal cross spacing. Because the height of the rectangular SE $B^1$ (Figure~\ref{fig:SE_B1}) is exactly $L$, it fits the left- and right sections of the cross perfectly. Because the origin is at center, what is left after the erosion operation is only a small horizontal section. The dilation operation, on the other hand, then again increases the amount of foreground pixels by enlarging the shape. The fact that the $B^3$ origin is at the bottom right position of the shape does not much influence the dilation operation (it would for the erosion operation).

\subsection*{(c)} Lastly, we dilate by $B^1$ and then dilate again, but by $B^3$, i.e. $(A \oplus B^1) \oplus B^3$. The result of this operation can be seen in Figure~\ref{fig:ex1_c}.

\begin{figure}[H]
     \centering
     \begin{subfigure}[b]{0.27\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/pen&paper/A.svg}
         \caption{The input set $A$.}
         \label{fig:ex1_c-inputset}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.29\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/pen&paper/(c)-step1.svg}
         \caption{$(A \oplus B^1)$}
         \label{fig:ex1_c-step1}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.37\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/pen&paper/(c)-step2.svg}
         \caption{$(A \oplus B^1) \oplus B^3$}
         \label{fig:ex1_c-step2}
     \end{subfigure}
     
    \caption{Overview of the two dilation operations of assignment (c), using the SE's $B^1$ (Figure~\ref{fig:SE_B1}) and $B^3$ (Figure~\ref{fig:SE_B3}).}
    \label{fig:ex1_c}
\end{figure}

Both dilation operations enlarge the shape. The first, however, does so mainly in vertical estate; using the $B^1$ SE the most hits occur in the vertical direction. We do get some horizontal enlargement too, but this is confined to a little less than $L/4$ on all horizontal edges. The last dilation operation enlarges the entire shape in all directions. Note again that the non-centered origin of $B^3$ does not have a major impact in the result of the dilation operation.

\section*{Exercise 2}

\begin{figure}[H]
     \centering
     \begin{subfigure}[b]{0.75\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/wirebondmask_original.svg}
         \caption{The input image $I$.}
         \label{fig:wirebondmask-image}
     \end{subfigure}
     \newline
     \hfill
     \begin{subfigure}[b]{0.33\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/Bcross.svg}
         \caption{$Bcross$ (3x3 SE)}
         \label{fig:Bcross}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.33\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/Bsquare.svg}
         \caption{$Bsquare$  (3x3 SE)}
         \label{fig:Bsquare}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.33\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/Bbigsquare.svg}
         \caption{$Bbigsquare$ (15x15 SE)}
         \label{fig:Bbigsquare}
     \end{subfigure}
     
    \caption{Overview of the input image $I$ and the Structuring Elements (SE's), $Bcross$, $Bsquare$ and $Bbigsquare$ used to test the morphological functions that follow. Two $3 \times 3$ SE's are defined and one $15 \times 15$ SE to investigate functionality using a larger SE.}
    \label{fig:structuring-elements-overview}
\end{figure}

\subsection*{(a)} In this first assignment, we apply the morphological \textbf{dilation} transformation. 
\begin{figure}[H]
     \centering
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/wirebondmask_Bcross_dilated.svg}
         \caption{$I \oplus Bcross$}
         \label{fig:wirebondmask_Bcross_dilated}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/wirebondmask_Bsquare_dilated.svg}
         \caption{$I \oplus Bsquare$}
         \label{fig:wirebondmask_Bsquare_dilated}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/wirebondmask_Bbigsquare_dilated.svg}
         \caption{$I \oplus Bbigsquare$}
         \label{fig:wirebondmask_Bbigsquare_dilated}
     \end{subfigure}
     
    \caption{Dilation transformations on $I$ (Figure~\ref{fig:wirebondmask-image}) using the \textsc{IPdilate} function and the Structuring Elements like defined in Figure~\ref{fig:structuring-elements-overview}.}
    \label{fig:wirebondmask_dilated}
\end{figure}

\begin{figure}[H]
     \centering
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/wirebondmask_Bbigsquare_IPdilate.svg}
         \caption{\textsc{IPdilate}}
         \label{fig:wirebondmask_Bbigsquare_IPdilate}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/wirebondmask_Bbigsquare_imdilate.svg}
         \caption{\textsc{imdilate}}
         \label{fig:wirebondmask_Bbigsquare_imdilate}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/wirebondmask_Bbigsquare_dilate_diff.svg}
         \caption{Difference}
         \label{fig:wirebondmask_Bbigsquare_dilate_diff}
     \end{subfigure}
     
    \caption{$I \oplus Bbigsquare$ executed using both \textsc{IPdilate} and \textsc{imdilate}, and the difference between the two results.}
    \label{fig:wirebondmask_dilate_diff}
\end{figure}

\subsection*{(b)} In this second assignment, we apply the morphological \textbf{erosion} transformation. 

\begin{figure}[H]
     \centering
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/wirebondmask_Bcross_eroded.svg}
         \caption{$I \ominus Bcross$}
         \label{fig:wirebondmask_Bcross_eroded}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/wirebondmask_Bsquare_eroded.svg}
         \caption{$I \ominus Bsquare$}
         \label{fig:wirebondmask_Bsquare_eroded}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/wirebondmask_Bbigsquare_eroded.svg}
         \caption{$I \ominus Bbigsquare$}
         \label{fig:wirebondmask_Bbigsquare_eroded}
     \end{subfigure}
     
    \caption{Erosion transformations on $I$ (Figure~\ref{fig:wirebondmask-image}) using the \textsc{IPerode} function and the Structuring Elements like defined in Figure~\ref{fig:structuring-elements-overview}.}
    \label{fig:wirebondmask_eroded}
\end{figure}

\begin{figure}[H]
     \centering
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/wirebondmask_Bbigsquare_IPerode.svg}
         \caption{\textsc{IPerode}}
         \label{fig:wirebondmask_Bbigsquare_IPerode}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/wirebondmask_Bbigsquare_imerode.svg}
         \caption{\textsc{imerode}}
         \label{fig:wirebondmask_Bbigsquare_imerode}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/wirebondmask_Bbigsquare_erode_diff.svg}
         \caption{Difference}
         \label{fig:wirebondmask_Bbigsquare_erode_diff}
     \end{subfigure}
     
    \caption{$I \ominus Bbigsquare$ executed using both \textsc{IPerode} and \textsc{imerode}, and the difference between the two results.}
    \label{fig:wirebondmask_erode_diff}
\end{figure}

\subsection*{(c)}
\begin{figure}[H]
     \centering
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/wirebondmask_11x11SE_erode.svg}
         \caption{Erosion using $11 \times 11$ SE}
         \label{fig:book9.5figure-wirebondmask-image-11x11}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/wirebondmask_15x15SE_erode.svg}
         \caption{Erosion using $15 \times 15$ SE}
         \label{fig:book9.5figure-wirebondmask-image-15x15}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/wirebondmask_45x45SE_erode.svg}
         \caption{Erosion using $45 \times 45$ SE}
         \label{fig:book9.5figure-wirebondmask-image-45x45}
     \end{subfigure}
     
    \caption{Erosion of the Wirebondmask image (Figure~\ref{fig:wirebondmask-image}), using various-sized square SE's, recreating part of Figure 9.5 from the book \citep{gonzalez2008digital}.}
    \label{fig:book9.5figure}
\end{figure}

\section*{Exercise 3}

% TODO add text and stuff


\begin{figure}[h]
     \centering
     \begin{subfigure}[b]{0.45\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/input_images/skeleton_input.svg}
         \caption{Erosion using $11 \times 11$ SE}
         \label{fig:book9.5figure-wirebondmask-image-11x11}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.45\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/skeleton_reconstruction.svg}
         \caption{Erosion using $15 \times 15$ SE}
         \label{fig:book9.5figure-wirebondmask-image-15x15}
     \end{subfigure}
     \newline
     \begin{subfigure}[b]{0.45\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/skeleton_skeleton.svg}
         \caption{Erosion using $45 \times 45$ SE}
         \label{fig:book9.5figure-wirebondmask-image-45x45}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.45\textwidth}
         \centering
         \includesvg[width=\textwidth]{Assignment_4/output_plots/skeleton_difference.svg}
         \caption{Erosion using $45 \times 45$ SE}
         \label{fig:book9.5figure-wirebondmask-image-45x45}
     \end{subfigure}
     
    \caption{Erosion of the Wirebondmask image (Figure~\ref{fig:wirebondmask-image}), using various-sized square SE's, recreating part of Figure 9.5 from the book \citep{gonzalez2008digital}.}
    \label{fig:book9.5figure}
\end{figure}

\section*{Individual contributions}
\begin{itemize}
    \item \textbf{Exercise 1 and 2}. Contribution to program design, program implementation, answering questions posed and writing the report: \textit{Jeroen} 100\%.
    \item \textbf{Exercise 3}. Contribution to program design, program implementation, answering questions posed and writing the report: \textit{Kevin} 100\%.
\end{itemize}

\bibliographystyle{plain}
\typeout{}
\bibliography{Assignment_4}

\newpage
\appendix
\section{Code}
\subsection{Exercise 2}
\lstinputlisting[caption={IPmorph.m: perform morphological transformations, namely \textit{dilation} and \textit{erosion}, using a single function.}, label={code:IPmorph}]{Assignment_4/IPmorph.m}

\subsubsection{Exercise 2 (a)}
\lstinputlisting[caption={\texttt{IPdilate.m}: perform dilation using \textsc{IPmorph} (Listing~\ref{code:IPmorph}).}, label={code:IPdilate}]{Assignment_4/IPdilate.m}
\subsubsection{Exercise 2 (b)}
\lstinputlisting[caption={\texttt{IPerode.m}: perform dilation using \textsc{IPmorph} (Listing~\ref{code:IPmorph}).}, label={code:IPerode}]{Assignment_4/IPerode.m}
\subsubsection{Exercise 2 (c)}
\lstinputlisting[caption={\texttt{IPdilate\_erode\_test.m}: Test script to demonstrate the functionality of both \textsc{IPdilate} and \textsc{IPerode}. Saves images to .svg files.}, label={code:IPdilate_erode_test}]{Assignment_4/IPdilate_erode_test.m}

\subsection{Exercise 3}
\subsubsection{Exercise 3 (a)}
\lstinputlisting[caption={\texttt{IPskeletondecomp.m}: Perform skeleton decomposition of the binary input image.}, label={code:IPskeletondecomp}]{Assignment_4/IPskeletondecomp.m}
\subsubsection{Exercise 3 (b)}
\lstinputlisting[caption={\texttt{IPskeletonrecon.m}: Perferm image reconstruction using the skeleton.}, label={code:IPskeletonrecon}]{Assignment_4/IPskeletonrecon.m}
\subsubsection{Exercise 3 (c)}
\lstinputlisting[caption={\texttt{IPskeleton\_test.m}: Test script to demonstrate the functionality of both \textsc{IPskeletondecomp} and \textsc{IPskeletonrecon}.}, label={code:IPskeleton_test}]{Assignment_4/IPskeleton_test.m}
\end{document}
